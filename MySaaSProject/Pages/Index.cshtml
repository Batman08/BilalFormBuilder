@page
@model IndexModel
@{
    ViewData["Title"] = "BilalFormBuilder";
}

@*add form element section*@
<button id="btnFormElements" class="btn btn-primary rounded-pill" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Add Form Element</button>

<div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Form Elements</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="basic-elments-tab" data-bs-toggle="tab" data-bs-target="#basic-elments-tab-pane" type="button" role="tab" aria-controls="basic-elments-tab-pane" aria-selected="true">Basic Elements</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="complex-elements-tab" data-bs-toggle="tab" data-bs-target="#complex-elements-tab-pane" type="button" role="tab" aria-controls="complex-elements-tab-pane" aria-selected="false">Complex Elements</button>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <br />

            <div class="tab-pane fade show active" id="basic-elments-tab-pane" role="tabpanel" aria-labelledby="basic-elments-tab" tabindex="0">
                <div class="formElementsCategory">
                    <ul id="basicFormElements" class="formElementList bg-indigo-500"></ul>
                </div>
            </div>
            <div class="tab-pane fade" id="complex-elements-tab-pane" role="tabpanel" aria-labelledby="complex-elements-tab" tabindex="0">
                <div class="formElementsCategory">
                    <ul id="formElements" class="formElementList bg-indigo-500">
                        <li role="button" class="listAddFormElementWrapper bg-indigo-500" data-element-type="formElementHeading">
                            <div class="formElementIcon bg-indigo-700">
                                <span><i class="fas fa-heading fa-sm"></i></span>
                            </div>
                            <div class="formElementName">Heading</div>
                        </li>
                        <li role="button" class="listAddFormElementWrapper bg-indigo-500" data-element-type="formElementFullName">
                            <div class="formElementIcon bg-indigo-700">
                                <span><i class="fas fa-user-circle fa-sm"></i></span>
                            </div>
                            <div class="formElementName">Full Name</div>
                        </li>
                        <li role="button" class="listAddFormElementWrapper bg-indigo-500" data-element-type="formElementEmail">
                            <div class="formElementIcon bg-indigo-700">
                                <span><i class="far fa-envelope fa-sm"></i></span>
                            </div>
                            <div class="formElementName">Email</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@*form designer button*@
<button id="btnFormDesigner" class="btn btn-primary rounded-pill" type="button" style="float:right" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">Form Designer</button>

<div class="offcanvas offcanvas-end" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasDesignerRightLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasDesignerRightLabel"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general-tab-pane" type="button" role="tab" aria-controls="general-tab-pane" aria-selected="true">General</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="form-html-tab" data-bs-toggle="tab" data-bs-target="#form-html-tab-pane" type="button" role="tab" aria-controls="form-html-tab-pane" aria-selected="false">Form Html</button>
            </li>
            @*<li class="nav-item" role="presentation">
            <button class="nav-link" id="options-tab" data-bs-toggle="tab" data-bs-target="#options-tab-pane" type="button" role="tab" aria-controls="options-tab-pane" aria-selected="false">Options</button>
            </li>*@
        </ul>
        <div class="tab-content" id="myTabContent">
            <br />

            <div class="tab-pane fade show active" id="general-tab-pane" role="tabpanel" aria-labelledby="general-tab" tabindex="0">
                <div id="rightDesigner">
                    <div class="mb-3">
                        <label for="txtHeading" class="form-label">Heading Texts</label>
                        <input type="text" class="form-control" id="txtHeading" data-reference aria-describedby="Heading Text">
                    </div>
                    <div class="mb-3">
                        <label for="txtSubHeading" class="form-label">Subheading Text</label>
                        <input type="text" class="form-control" id="txtSubHeading">
                    </div>
                </div>

                @*<div id="propertiesDesigner" class="hideElement"></div>*@
            </div>

            @*Form Html*@
            <div class="tab-pane fade" id="form-html-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
                @*Link to Bootstrap version*@
                <div>
                    <h3>Bootstrap V5.1.3</h3>
                    <div class="input-group mb-3">
                        <input type="text" id="txtBootstrapLinkTag" class="form-control" placeholder="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" readonly>
                        <button class="btn btn-outline-secondary" type="button" id="btnCopyBootstrapLinkTag" data-bs-toggle="tooltip" data-bs-placement="top" title="Copied!">Copy</button>
                    </div>
                </div>

                <hr />

                @*Form Html Input*@
                <div>
                    <button type="button" id="btnCopyFormHtml" class="btn btn-primary w-100" data-bs-toggle="tooltip" data-bs-placement="top" title="Copied!">Copy HTML</button>

                    <textarea class="form-control mt-3" id="formHtmlCode" rows="10" disabled readonly></textarea>
                </div>
            </div>
            @*<div class="tab-pane fade" id="options-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0"></div>*@
            @*<div class="tab-pane fade" id="disabled-tab-pane" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">...</div>*@
        </div>
    </div>
</div>

@*<div class="text-center">*@
<form id="FormBuilderArea">
    <div class="row">
        <div id="customFormArea" class="col-md-6 mx-auto">
            <div id="customFormWrapper" style="border-radius: 3px; box-shadow: 0 4px 4px rgb(87 100 126 / 21%);">
                <div id="customFormSection" style="min-height: 64px;"></div>@*padding:0 38px;*@
            </div>
        </div>
    </div>
</form>
@*</div>*@

@*external scripts*@
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

<script src="/js/Utilities.js"></script>
<script src="/js/FormElements.js"></script>
<script src="/js/FormElementProperties.js"></script>
<script src="/js/FormBuilder.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function (event) {
        Utilities.BTSP_InitTooltips();

        var sortableBasicComponents = new Sortable(basicFormElements, {
            group: {
                name: 'shared',
                pull: 'clone',
                put: false // Do not allow items to be put into this list
            },
            filter: '.filteredComponent', // 'filtered' class is not draggable
            animation: 150,
            sort: false // To disable sorting: set sort to false
        });

        var sortableComplexComponents = new Sortable(formElements, {
            group: {
                name: 'shared',
                pull: 'clone',
                put: false // Do not allow items to be put into this list
            },
            animation: 150,
            sort: false // To disable sorting: set sort to false
        });

        var sortableFormElements = new Sortable(customFormSection, {
            group: 'shared',
            animation: 150,
            onAdd: function (evt) {
                formBuilder.AddElementFromDrag(evt.item);
            },
            ghostClass: 'draggableGhost'
        });

        const formBuilder = new FormBuilder();
        formBuilder.Init(sortableFormElements);
    });
</script>