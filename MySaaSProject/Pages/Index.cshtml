@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}

@*add form element section*@
<button class="btn btn-primary rounded-pill" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Add Form Element</button>

<div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Form Elements</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="basic-elments-tab" data-bs-toggle="tab" data-bs-target="#basic-elments-tab-pane" type="button" role="tab" aria-controls="basic-elments-tab-pane" aria-selected="true">Basic Elements</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="complex-elements-tab" data-bs-toggle="tab" data-bs-target="#complex-elements-tab-pane" type="button" role="tab" aria-controls="complex-elements-tab-pane" aria-selected="false">Complex Elements</button>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <br />
            
            <div class="tab-pane fade show active" id="basic-elments-tab-pane" role="tabpanel" aria-labelledby="basic-elments-tab" tabindex="0">
                <div class="formElementsCategory">
                    <ul id="basicFormElements" class="formElementList bg-indigo-500"></ul>
                </div>
            </div>
            <div class="tab-pane fade" id="complex-elements-tab-pane" role="tabpanel" aria-labelledby="complex-elements-tab" tabindex="0">
                <div class="formElementsCategory">
                    <ul id="formElements" class="formElementList bg-indigo-500">
                        <li role="button" class="listAddFormElementWrapper bg-indigo-500" data-element-type="formElementHeading">
                            <div class="formElementIcon bg-indigo-700">
                                <span><i class="fas fa-heading fa-sm"></i></span>
                            </div>
                            <div class="formElementName">Heading</div>
                        </li>
                        <li role="button" class="listAddFormElementWrapper bg-indigo-500" data-element-type="formElementFullName">
                            <div class="formElementIcon bg-indigo-700">
                                <span><i class="fas fa-user-circle fa-sm"></i></span>
                            </div>
                            <div class="formElementName">Full Name</div>
                        </li>
                        <li role="button" class="listAddFormElementWrapper bg-indigo-500" data-element-type="formElementEmail">
                            <div class="formElementIcon bg-indigo-700">
                                <span><i class="far fa-envelope fa-sm"></i></span>
                            </div>
                            <div class="formElementName">Email</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@*form designer/elemment properties*@
<button class="btn btn-primary rounded-pill" type="button" style="float:right" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">Form Designer</button>

<div class="offcanvas offcanvas-end" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasRightLabel">Form Designer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Home</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">Profile</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">Contact</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="disabled-tab" data-bs-toggle="tab" data-bs-target="#disabled-tab-pane" type="button" role="tab" aria-controls="disabled-tab-pane" aria-selected="false" disabled>Disabled</button>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                <div id="formDesigner">
                    <h1>Form Designer</h1>

                    <br />

                    <div class="mb-3">
                        <label for="txtHeading" class="form-label">Heading Texts</label>
                        <input type="text" class="form-control" id="txtHeading" data-reference aria-describedby="Heading Text">
                    </div>
                    <div class="mb-3">
                        <label for="txtSubHeading" class="form-label">Subheading Text</label>
                        <input type="text" class="form-control" id="txtSubHeading">
                    </div>
                </div>

                <div id="propertiesDesigner" class="hideElement"></div>
            </div>

            <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                <h1>Advanced</h1>
            </div>
            <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">...</div>
            <div class="tab-pane fade" id="disabled-tab-pane" role="tabpanel" aria-labelledby="disabled-tab" tabindex="0">...</div>
        </div>
    </div>
</div>

<div class="text-center">
    <div class="row">
        <div id="customFormArea" class="col-md-6 mx-auto">
            <div id="customFormWrapper" style="border-radius: 3px; box-shadow: 0 4px 4px rgb(87 100 126 / 21%);">
                <div id="customFormSection" style="min-height: 64px"></div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

<script src="/typescript/FormElements.js"></script>
<script src="/typescript/FormElementProperties.js"></script>
<script src="/typescript/Utilities.js"></script>
<script src="/typescript/FormBuilder.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function (event) {

        const formBuilder = new FormBuilder();

        new Sortable(formElements, {
            group: {
                name: 'shared',
                pull: 'clone',
                put: false // Do not allow items to be put into this list
            },
            animation: 150,
            sort: false // To disable sorting: set sort to false
        });

        //Change order of form elements
        new Sortable(customFormSection, {
            group: 'shared',
            animation: 150,
            onAdd: function (evt) {
                formBuilder.AddElementFromDrag(evt.item);
            },
            ghostClass: 'draggableGhost'
        });
    });
</script>